<!--web10902-->
<html>
<head><title>Yahoo! Mail</title></head>
<body alink=#0000ff vlink=#0000ff bgcolor=#ffffff>
<script language="JavaScript">
<!-- 
function Help(daLink) {
    var helpWnd=window.open(daLink,"help","width=400,height=500,scrollbars=yes,dependent=yes");
}
// -->
</script>


<table border=0 cellpadding=0 cellspacing=0 width=100% height="52" >
<tr>
<td nowrap align=left>
<font size=2 face="Arial,Helvetica" ><b><a href="/ym/us/ShowFolder?box=Inbox&YY=3721&order=down&sort=date&pos=4">Inbox</a> for connorbd@yahoo.com</b>&nbsp;&nbsp;&nbsp;</font>
</td>
<td nowrap align=right><font size=2 face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://www.yahoo.com" target="_blank">Yahoo!</a> 
 
- <a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://my.yahoo.com" target="_blank">My Yahoo!</a>
 
&nbsp;&nbsp;&nbsp;
<a href="/ym/Options?YY=3721&order=down&sort=date&pos=4">Options</a> - 
<a href="/ym/Logout?YY=3721&order=down&sort=date&pos=4" target="_top">Sign Out</a> - 
<a href="javascript:Help('http://rd.yahoo.com/mail_us/help/?http://help.yahoo.com/help/us/mail/context/context-18.html')">Help</a>
</font></td>
</tr>
<tr height="2"><td height="2" colspan=2><img src="http://us.i1.yimg.com/us.yimg.com/i/pim/line.gif" height=2 width=100%></td>
</tr>
<tr height="25">
<td><table border=0 cellpadding=0 cellspacing=0><tr><td>
<a href="http://rd.yahoo.com/M=179842.1351603.2941484.1284474/D=mail/P=m2b02de9110e04/S=150500004:PB/A=604092/R=0/*http://promo.yahoo.com/compaq/"><img src="http://us.a1.yimg.com/us.yimg.com/a/co/compaq/redcompaq.gif" alt="" border="0" align="right" width="76" height="24"></a></td></tr></table></td>
<td valign=middle nowrap align=right height="25">
<table border=0 cellpadding=0 cellspacing=0>
<tr>
<td valign=middle><font size=1 face="Arial,Helvetica" >
<a href="/ym/welcome?YY=3721&order=down&sort=date&pos=4"><img src="http://us.i1.yimg.com/us.yimg.com/i/pim/mls2.gif" height=24 width=24 border=0></a>
</font></td>
<td nowrap valign=middle><font size="1" face="Arial,Helvetica" >
<a href="/ym/welcome?YY=3721&order=down&sort=date&pos=4">Mail</a>&nbsp;&nbsp;&nbsp;
</font></td>
<td valign=middle><font size=1 face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://address.yahoo.com/yab/us/?YY=3721" target="_top"><img src="http://us.i1.yimg.com/us.yimg.com/i/pim/ad2.gif" height=24 width=24 border=0></a>
</font></td>
<td nowrap valign=middle><font size="1" face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://address.yahoo.com/yab/us/?YY=3721" target="_top">Addresses</a>&nbsp;&nbsp;&nbsp;
</font></td>
<td valign=middle><font size=1 face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://calendar.yahoo.com" target="_top">
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://calendar.yahoo.com/?YY=3721&a9=ym:nav" target="_top">
<img src="http://us.i1.yimg.com/us.yimg.com/i/pim/cl2.gif" height=24 width=24 border=0></a>
</font></td>
<td nowrap valign=middle><font size="1" face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://calendar.yahoo.com" target="_top">
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://calendar.yahoo.com/?YY=3721&a9=ym:nav" target="_top">
Calendar</a>&nbsp;&nbsp;&nbsp;
</font></td>
<td valign=middle><font size=1 face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://notepad.yahoo.com/?YY=3721" target="_top"><img src="http://us.i1.yimg.com/us.yimg.com/i/pim/np2.gif" height=24 width=24 border=0></a>
</font></td>
<td nowrap valign=middle><font size="1" face="Arial,Helvetica" >
<a href="http://rd.yahoo.com/mail_us/pimnav/letter/?http://notepad.yahoo.com/?YY=3721" target="_top">Notepad</a>&nbsp;&nbsp;&nbsp;
</font></td>
</tr>
</table></td>
</tr>
<tr height="2">
<td height="2" colspan=2><img src="http://us.i1.yimg.com/us.yimg.com/i/pim/line.gif" height=2 width=100%></td>
</tr>
</table>
<br> 

<!-- set .adlkp_no_valid_ads=1 -->
<!-- set .NO_ADS=1 -->
<script language="JavaScript">
<!-- 
function SynchMoves(primary) {
if(primary==1) document.frmShowLtr2.destBox.selectedIndex = document.frmShowLtr.destBox.selectedIndex;
else document.frmShowLtr.destBox.selectedIndex = document.frmShowLtr2.destBox.selectedIndex;
}
function MoveTo() {
dml=document.frmShowLtr;
dbox=dml.destBox;
if(dbox.options[dbox.selectedIndex].value != "@NEW") {
dml.MOV.value=1;
dml.submit();
return;
}
nn=window.prompt("Please enter a name for your folder.","");
if(nn==null || nn=="null" || nn=="") {
dbox.selectedIndex=0;
document.frmShowLtr2.destBox.selectedIndex=0;
return;
}
dml.NewFol.value=nn;
dml.MOV.value=1;
dml.submit();
}
//-->
</script>

<table cellpadding=2 cellspacing=0 border=0 width="100%">

<tr><td align=center colspan=2>
<form action="http://rd.yahoo.com/M=210168.1515474.3092308.313120/D=mail/P=m2b02de9110e04/S=150500004:N/A=767627/R=0/*http://www.ediets.com/start.cfm?code=30219" target="_blank" method="get"><input type="hidden" name="code" value="30219"><input type="hidden" name="sex" value="male"><table cellpadding="0" cellspacing="0" border="0" width="468" bgcolor="#ffcc00"><tr><td align="right" valign="top"><a href="http://rd.yahoo.com/M=210168.1515474.3092308.313120/D=mail/P=m2b02de9110e04/S=150500004:N/A=767627/R=1/*http://www.ediets.com/start.cfm?code=30219&sex=male" target="_blank"><img src="http://us.a1.yimg.com/us.yimg.com/a/ed/ediets_men/image_10d.gif" width="120" height="60" alt="" border="0"></a></td><td align="right" valign="top"><table border="0" bgcolor="#ffcc00" cellpadding="0" cellspacing="0"><tr>	<td align="right" valign="top"><a href="http://rd.yahoo.com/M=210168.1515474.3092308.313120/D=mail/P=m2b02de9110e04/S=150500004:N/A=767627/R=2/*http://www.ediets.com/start.cfm?code=30219&sex=male" target="_blank"><img src="http://us.a1.yimg.com/us.yimg.com/a/ed/ediets_men/0604_02_texte.gif" width="348" height="30" alt="" border="0"></a></td></tr><tr><td colspan="2" valign="top" align="center"><font face="arial" size="2" color="black"><b> Height</b> </font> <select name="htft"><option value=4 >4 <option value=5>5 <option value=6 selected >6 <option value=7>7 </select><font face="arial" size="1" color="black"> <b>ft</b> </font><select name=htin><option value=0>0 <option value=1 selected>1 <option value=2>2 <option value=3>3 <option value=4>4 <option value=5>5 <option value=6>6 <option value=7>7 <option value=8>8 <option value=9>9 <option value=10>10 <option value=11>11 </select><font face="arial" size="1" color="black"> <b>in</b> </font><font face="arial" size="2" color="black"><b>Weight</b> </font><input type="text" style="font-size: 12; color: #000; font-family: arial;" value="" name="wt" size="3" maxlength="3"> <input type="submit" value="go!"> <input type="hidden" name="sex" value="male"></td></tr></table></td></tr></table></form></td></tr>
<tr><td height=8 colspan=2></td></tr>







<form name=frmCompose method=post action="/ym/Compose?box=Inbox&Mid=8678_3422754_123032_1024_22001_0_0&inc=&Search=&YY=3721&order=down&sort=date&pos=4">
<tr bgcolor="#ffffff">
<td nowrap valign=middle>
<input type=submit name=REP value="Reply">
<input type=submit name=REPA value="Reply All">
<input type=submit name=FWD value="Forward">
<font face="Arial,Helvetica" size=-2>
<select name="fwopt">
<option value="attach" selected>as attachment
<option value="quoted">inline text
</select>
</font>
</td>
<td align=right valign=middle nowrap><font face="Arial,Helvetica" size=-1>
<a href="/ym/ShowLetter?box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&toc=1&Search=&YY=3721&order=down&sort=date&pos=4"><b>Download</b></a> Attachments
</font></td>
</tr>
</form>

<form name=frmShowLtr method=post action="/ym/ShowLetter?YY=3721&order=down&sort=date&pos=4">
<input type=hidden name="MsgId" value="8678_3422754_123032_1024_22001_0_0">
<input type=hidden name=box value="Inbox">

<tr bgcolor=#9bbad6>
<td nowrap valign=middle><font face="Arial,Helvetica" size=-1>
<input type=submit name=DEL value="Delete">&nbsp;&nbsp;&nbsp;
<b><a href="/ym/ShowLetter?box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&PREV=1&inc=&num=&Search=&YY=3721&order=down&sort=date&pos=4">Prev</a></b>
|
<b><a href="/ym/ShowLetter?box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&NEXT=1&inc=&num=&Search=&YY=3721&order=down&sort=date&pos=4">Next</a></b>

| <b><a href="/ym/ShowFolder?box=Inbox&YY=3721&order=down&sort=date&pos=4">Inbox</a></b>
</font></td>
<td align=right nowrap><font face="Arial,Helvetica" size=-1>
<select name="destBox" onchange="SynchMoves(1);">
<option value="">- Choose Folder -
<option value="@NEW">[New Folder]
<option value="oracularities">oracularities
</select>
<input type=button value="Move" onclick="MoveTo()">
<input type=hidden name=MOV value="">
<input type=hidden name=NewFol value="">
</font></td>
</tr>
</form>
</table>


<table cellspacing=0 cellpadding=0 width="100%">
<tr valign=top><td><table cellspacing=0 cellpadding=1>
<tr><td align=right valign=top nowrap><b>Date:</b></td><td> Sat, 28 Jul 2001 14:50:25 -0400</td></tr>
<tr><td align=right valign=top nowrap><b>From:</b></td><td> Jeff Evarts &lt;riventree@earthlink.net&gt;&nbsp;|&nbsp;<b><a href="/ym/BlockSender?NBR=1&NE=riventree@earthlink.net&box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&inc=&num=&Search=&YY=3721&order=down&sort=date&pos=4">Block Address</a></b>&nbsp;|&nbsp;<b><a href="javascript:document.frmAddAddrs.submit()">Add to Address Book</a></b></font></td></tr>
<tr><td align=right valign=top nowrap><b>To:</b></td><td> Brian Connors &lt;connorbd@yahoo.com&gt;</td></tr>
<tr><td align=right valign=top nowrap><b>Subject:</b></td><td> Re: Control Statement Bug?</td></tr>
</table></td>
<td valign=top><form name=frmAddAddrs action="http://address.mail.yahoo.com/yab/us?v=YM&cmode=1&Lang=us" method="post">
<table cellpadding=0 cellspacing=0 border=0 width="100%">
<tr valign=top><td bgcolor="#ffffff" align=right>
<font face="Arial" size="-1">
<input type="hidden" name="v" value="YM">
<input type="hidden" name="A" value="a">
<input type="hidden" name="fn" value="Jeff,Brian,">
<input type="hidden" name="ln" value="Evarts,Connors,">
<input type="hidden" name="e" value="riventree@earthlink.net,connorbd@yahoo.com,">
<input type="hidden" name="m" value="1">
<input type="hidden" name=".done" value="http://us.f109.mail.yahoo.com/ym/ShowLetter?MsgId=8678_3422754_123032_1024_22001_0_0&order=down&inc=&sort=date&box=Inbox&YY=3721">
</font>
</td></tr>
</table>
</form></td>
</tr>
</table>
<br>



<pre>With bug fixed.

-Jeff
--
-Jeff Evarts
<a href="/ym/Compose?To=--riventree@earthlink.net&YY=3721&order=down&sort=date&pos=4">--riventree@earthlink.net</a>
---<a href="http://www.ecst.csuchico.edu/~amarth/" target=_blank>http://www.ecst.csuchico.edu/~amarth/</a></font></pre>


<HR size=1><pre>#!/usr/bin/perl

# varaq-engl
#
# An English translation of var'aq, the "Klingon Forth".
#
# Last updated 9/19/2000.
# (Jul 14 2000: Chris Pressey generally hacks source to bits and
#  sends back to Brian Connors...)
# (19 sep 2000: j proctor adds some stuff...
#
# (c)2000 Brian Connors (idea, semantics) and Chris Pressey (parsing 
logic
# and general plumbing) under terms of the Mozilla Public License (see 
# <a href="http://www.mozilla.org" target=_blank>http://www.mozilla.org</a> for details). 

# A note on comments: I don't distinguish my code from the other guy's 
code,
# so you'll just have to guess which is which. (Or for that matter who 
wrote
# which comment.)

### GLOBAL VARIABLES ###

$line  = '';  # last line of text read from the input file
$token = '';  # last token parsed out of $line of text
$proc  = {};  # dictionary of procedure names to defn's
$stack = [];  # ooh, a stack, the last thing you'd expect here :-)

%vars  = ();  # dictionary of variables names to values

# For nice clean handling of lambda functions, we'll probably want
# to merge $proc and %vars into a single dictionary

### LINEAR SCANNER ###

# exact syntax for comments &amp; strings needs to be determined

sub token
{
  my $t = '';

RestartScan:

  while ($line =~ /^\s*$/)  # Get next line if we used up the current 
line
  {
    $line = &lt;STDIN&gt;;
    return undef if not defined $line;
    chomp $line;
    $line =~ s/^\s*//;
  }

# Remove any whitespace before the next token

  $line =~ s/^\s*//;

# Assuming strings look like "this", and comments look like (* this *).

  if ($line =~ /^\(\*(.*?)\*\)/)
  {
    $line = $';
    goto RestartScan;

 } elsif ($line =~ /^#!(.*?)$/) {	#to recognize hashbang lines --
					# you won't find this documented
					# in the spec
	$line = $';
    goto RestartScan;
 } elsif ($line =~ /^\/\/(.*?)$/) {	#To avoid import symbols
	$line = $';
    goto RestartScan;
  } elsif ($line =~ /^(\".*?\")/)
  {
    $t = $1;
    $line = $';
    return $t;
  } elsif ($line =~ /^(\S+)/)
  {
    $t = $1;
    $line = $';
    return $t;
  } else
  {
    $line = '';
    goto RestartScan;
  }
}

### RECURSIVE DESCENT PARSER ###

#defn has been modified to generate an array of tokens and push a
# reference on the stack to be bound to a name later.

# defn has been modified to handle nested definitions using recursion.
# defn itself does not touch the stack, as that would mean nested
# definitions would actually be 'spit out' onto the top level,
# which, unless it's what you want, probably isn't what you want
# (cf. Shelta.)

# defn now only returns a reference to the array that comprises the
# definition.  It's up to the caller (elem) to push that ref onto
# the stack.

sub defn
{
  my @temp = ();
  if ($token eq '{')
  {
    push @temp, 'code';
    $token = token();
    while($token ne '}')
    {
      if ($token eq '{')
      {
        push @temp, defn();
      }
      elsif ($token eq '(')
      {
	push @temp, mklist();
      }
#
# (Jeff) I *think* this else belongs here. It wasn't in the
# original code, so the push/token() was always executed next.
# I thought that might cause code that has  the sequence } { to
# be interpreted wrong, because the { would get pushed, rather
# than begin a new recursion. So I put an else around it. If this
# is wrong, please take it out of mklist() as well.
#
      else
      {
	push @temp, $token;
	$token = token();
      }
    }
    $token = token();
    return [@temp];
  } else
  {
    warn "Internal error: defn() should only be called at the start of 
a definition";
  }
}

#
# (Jeff)
#
# A coroutine for lists. Lists can be in code blocks, and
# vice versa. NB: calculated gotos get interesting here.
# you could argue that dup/pop/shatter is the only control
# structure you might need. Ick.
#
# In both routines, I added an "else" in the last stage,
# since I *think* not having it might be an error when two
# lists or code blocks butt up against one another...
#
# { "I am here" disp } { "here too" disp } seemed to
# push the second "{" instead of seeing it as the
# beginning of the next segment
#
# mklist and defn could/should be implemented as a 
# single routine that takes '}' or ')' as an argument
# (what the termination character is) but I didn't want
# to intrude too much on working code, so I left it like
# this for now.
#

sub mklist
{
  my @temp = ();
  if ($token eq '(')
  {
    push @temp, 'list';
    $token = token();
    while($token ne ')')
    {
      if ($token eq '(')
      {
        push @temp, mklist();
      }
      elsif ($token eq '{')
      {
	push @temp, defn();
      }
      else
      {
	push @temp, $token;
	$token = token();
      }
    }
    $token = token();
    return [@temp];
  } else
  {
    warn "Internal error: defn() should only be called at the start of 
a definition";
  }
}

sub elem
{
  if ($token eq '{')
  {	
    push @{$stack}, defn();
  } elsif ($token eq '(')
  {
    push @{$stack}, mklist();
  } elsif ($token eq 'quit')  # this should maybe be handled by 
'execute'
  {
    die "all done.\n";
  } else
  {
    execute($token);
    $token = token();
  }
}

sub parse
{
 	while(defined $token) {
    		elem();
  	}
}

### INTERPRETER ###

# Executing a proc object...

#
# (Jeff)
#
# I sucked some of the warnings up into this code block
# and adjusted it to skip over the "code" element in the
# list. This seemed more efficient than leaving this code
# in the ifyes/ifno/while execution below, especially if
# more control structures get added.
#
sub execblock {
	my $block = shift;
	my $i;
        if (ref($block) ne 'ARRAY')  # better safe than sorry
        {
        	warn "Can't execute a non-ARRAY reference as a routine";
        }
	elsif ($block-&gt;[0] ne 'code')
	{
		warn "Can't execute a non-code ARRAY";
	}
	else 
	{
		for ($i = 1; $i &lt;= $#{$block}; $i++)
		{
			execute($block-&gt;[$i]); # recursively exec procedure
		}
    	}
}

# composing a string

sub strcompose() {
	$s2 = pop @{$stack};
	$s1 = pop @{$stack};

	if ($s1 eq 'mk' || $s1 eq undef) {
		push @{$stack}, $s2;
	} else {
		push @{$stack}, $s1 . $s2;
		strcompose();
	}
}

# dump the stack
sub disparray {
	my $array = shift;
	my $i;

	if ($array-&gt;[0] eq 'list')
	{
		print '(';
	}
	elsif ($array-&gt;[0] eq 'code')
	{
		print '{';
	}
	else
	{
		warn 'Unknown array type';
	}

	for ($i = 1; $i &lt;= $#{$array}; $i++)
	{
		print ' ';
		if (ref($array-&gt;[$i]) eq 'ARRAY')
		{
			disparray ($array-&gt;[$i]);
		}
		else
		{
			print $array-&gt;[$i];
		}
	}

	if ($array-&gt;[0] eq 'list')
	{
		print ' )';
	}
	else
	{
		print ' }';
	}
}

# This is where most of the interesting stuff happens.

sub execute {
	my $temp;

  	my $cmd = shift;

# Just print it
# (Jeff) This does not work for:
#		( 1 2 3 ) disp
# since disp doesn't know about lists. Should it? Disp doesn't
# know about code either. Perhaps this and dump should both
# use the same routine for printing.

 	if($cmd eq 'disp') {
    		print pop @{$stack}, "\n";

# or bitch about it
	
	} elsif ($cmd eq 'complain') {
		print STDERR "Error: ", pop @{$stack}, "\n";

# but if you don't have it in the first place you have to get it
# from somewhere, yes?

	} elsif ($cmd eq 'listen') {
		$in = &lt;STDIN&gt;;
		push @{$stack}, $in;

# This may seem redundant, but a careful reading of the code indicates
# that elem() is called only once a line.
#
# (Chris) What?  No... elem() is called once per program element.
# A program element is a definition or an instruction in the main prog.
#
# (Brian) I knew I shoulda taken that left turn at Albuquerque...
#
# This clause duplicates its
# function for higher-level proc declarations (like say an iftrue 
clause)
# so this will actually work. It's a somewhat cheezy way of dealing 
with
# a really annoying bug, but here you go.
#
# (Chris) This IS redundant, because it can be (should be (is now))
# handled by the 'defn' production.
#
#	} elsif ($cmd eq '{') {
#		defn();

# (Chris) Instead, we may well be asked to execute a reference to an
# array: that is, a definition embedded into another definition.  It
# should come to us in the form of an ARRAY ref.  It's basically a
# literal value, so we do with it what we'd do with any literal
# value: push it onto the stack.

	} elsif (ref($cmd) eq 'ARRAY') {
		push @{$stack}, $cmd;
		
# dump is a debugging procedure. I don't know if it will be in the 
final
# language description, but I find it very useful for analyzing stack
# dynamics.
#
# (Jeff) I expanded it partially here to dump the contents of
# code segments and lists. This could be cleaned up too, but
# I just needed something quick &amp; dirty.


	} elsif ($cmd eq 'dump') {
		for ($i = 0; $i &lt;= $#{$stack}; $i++)
		{
			if ($i &gt; 0) 
			{
				print ' ';
			}
			if (ref($stack-&gt;[$i]) eq 'ARRAY')
			{
				disparray ($stack-&gt;[$i]);
			}
			else
			{
				print $stack-&gt;[$i];
			}
		}
		print "\n";
# some basic stack operations

	} elsif ($cmd eq 'pop') {	#pop
		pop @{$stack};
	} elsif ($cmd eq 'dup') {	#dup
#
# (Jeff) 'dup' duplicates lists by value, not by reference, so
#	( 1 2 3 ) dup split
# yields
#	( 1 2 3 ) ( 1 2 ) 3
# rather than
#	( 1 2 ) ( 1 2 ) 3
#
		$temp = pop @{$stack};
		if (ref($temp) ne 'ARRAY')
		{
			push @{$stack}, $temp;
			push @{$stack}, $temp; 
		}
		else
		{
		my $i;
		my $newarray = [ ];
			for ($i = 0; $i &lt;= $#{$temp}; $i++)
			{
				push @{$newarray}, $temp-&gt;[$i];
			}
			push @{$stack}, $temp;
			push @{$stack}, $newarray;
		}
	} elsif ($cmd eq 'exch') {	#exch
		$temp = pop @{$stack};
		$tempb = pop @{$stack};
		push @{$stack}, $temp;
		push @{$stack}, $tempb;
	} elsif ($cmd eq 'clear') {
		$stack = [];
	} elsif ($cmd eq 'remember') {
		push @{$stack}, 'mk';

# This is a tough one -- the obvious implementation never bottoms out 
if
# there is no marker on the stack. Rather than going on a downward 
spiral, the
# interpreter simply looks for an empty stack and pretends that it 
found a
# marker.

 	} elsif ($cmd eq 'forget') {
		my $pval = '';
		
		while ($pval ne 'mk') {   # could also say: while (defined($pval) and 
$pval ne 'mk')
			$pval = pop @{$stack};
			if ($pval eq undef) {  # then just toss this
				$pval = 'mk'; 	
			}
		}

# math operations

	} elsif ($cmd eq 'add') {
		$a = pop @{$stack};
		$b = pop @{$stack};
		push @{$stack}, $a + $b;
	} elsif ($cmd eq 'sub') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		push @{$stack}, $a - $b;
	} elsif ($cmd eq 'mul') {
		$a = pop @{$stack};
		$b = pop @{$stack};
		push @{$stack}, $a * $b;
	} elsif ($cmd eq 'div') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		push @{$stack}, $a/ $b; 	#best drop Larry a line about this;
					#$a/$b works, $a / $b doesn't. This
					# is clearly a bug.
                              # (Chris) I dunno, works on my Perl.  
This is Perl 5 right?
	} elsif ($cmd eq 'mod') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		push @{$stack}, $a % $b;
	} elsif ($cmd eq 'pow') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		push @{$stack}, $a ** $b;

	} elsif ($cmd eq 'rand') {
		$rn = rand (pop @{$stack});
		push @{$stack}, $rn;
	} elsif ($cmd eq 'clip') {
		$a = pop @{$stack};
		push @{$stack}, int($a);
	} elsif ($cmd eq 'smooth') {
		$a = pop @{$stack};
		push @{$stack}, int($a + .5);
	} elsif ($cmd eq 'howmuch') {
		$a = pop @{$stack};
		push @{$stack}, abs($a);

# increment/decrement

	} elsif ($cmd eq 'sub1') {
		$a = pop@{$stack};
		push @{$stack}, $a - 1;
	} elsif ($cmd eq 'add1') {
		$a = pop@{$stack};
		push @{$stack}, $a + 1

# SIHpoj jangwI'mey

	} elsif ($cmd eq 'sin') {
		$a = pop @{$stack};
		push @{$stack}, sin($a);
	} elsif ($cmd eq 'cos') {
		$a = pop @{$stack};
		push @{$stack}, cos($a);
	} elsif ($cmd eq 'tan') {
		$a = pop @{$stack};
		push @{$stack}, tan($a);
	} elsif ($cmd eq 'atan') {	#equivalent to atan2() in C
		$d = pop @{$stack};
		$n = pop @{$stack};
		push @{$stack}, atan2($n,$d);

# ghurjangwI'mey

	} elsif ($cmd eq 'ln') {
		$a = pop @{$stack};
		push @{$stack}, log($a);

# (Jeff) list operations, more to come

	} elsif ($cmd eq 'split') {
		my $list = pop @{$stack};
		my $head = $list-&gt;[$#{$list}];
		pop @{$list};
		push @{$stack}, $list;
		push @{$stack}, $head;
	} elsif ($cmd eq 'cons') {
		my $a = pop @{$stack};
		my $list = pop @{$stack};
		push @{$list}, $a;
		push @{$stack}, $list;
	} elsif ($cmd eq 'shatter') {
		my $list = pop @{$stack};
		my $i;
		for ($i = 1; $i &lt;= $#{$list}; $i++)
		{
			push @{$stack}, $list-&gt;[$i];
		}
	} elsif ($cmd eq 'empty') {
		my $list = $stack-&gt;[$#{$stack}];
		if (ref($list) ne 'ARRAY')
		{
			warn 'Cannot empty a non-array';
		}
		elsif ($#{$list} &gt; 0)
		{
			push @{$stack}, 0;
		}
		else
		{
			push @{$stack}, 1;
		}

# numerical constants

	} elsif ($cmd eq 'pi') {
		push @{$stack}, 3.141592654;
	} elsif ($cmd eq 'e') {
		push @{$stack}, 2.718281824;
		
# data tests
# provided by j proctor &lt;<a href="/ym/Compose?To=jproctor@oit.umass.edu&YY=3721&order=down&sort=date&pos=4">jproctor@oit.umass.edu</a>&gt;

        } elsif ($cmd eq 'number?') {
                $a = pop @{$stack};
                if ($a =~ /^-?\d+\.?\d*$/) {  # lifted from Cookbook 
p.44
                        push @{$stack}, 1;
                } else {
                        push @{$stack}, 0;
                }
        } elsif ($cmd eq 'int?') {
                $a = pop @{$stack};
                if ($a =~ /^-?\d+$/) {        # lifted from Cookbook 
p.44
                        push @{$stack}, 1;
                } else {
                        push @{$stack}, 0;
                }
        } elsif ($cmd eq 'negative?') {
                $a = pop @{$stack};
                if ($a &lt; 0) {
                        push @{$stack}, 1;
                } else {
                        push @{$stack}, 0;
                }
        } elsif ($cmd eq 'null?') {
                $a = pop @{$stack};
                if ($a eq "") {
                        push @{$stack}, 1;
                } else {
                        push @{$stack}, 0;
                }
                
# relational operators
#
# Note that the English keywords honor the ? convention. This is to
# maintain consistency with the use of -'a' in Klingon.

	} elsif ($cmd eq 'gt?') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		if ($a &gt; $b) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}
	} elsif ($cmd eq 'ge?') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		if ($a &gt;= $b) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}
	} elsif ($cmd eq 'lt?') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		if ($a &lt; $b) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}
	} elsif ($cmd eq 'le?') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		if ($a &lt;= $b) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}
	} elsif ($cmd eq 'eq?') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		if ($a == $b) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}	
	} elsif ($cmd eq 'ne?') {
		$b = pop @{$stack};
		$a = pop @{$stack};
		if ($a != $b) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}

# logical operators

	} elsif ($cmd eq 'and') {
		$a = pop @{$stack};
		$b = pop @{$stack};
		if ($a != 0 &amp;&amp; $b != 0) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 1;
		}
	} elsif ($cmd eq 'or') {
		$a = pop @{$stack};
		$b = pop @{$stack};
		if ($a != 0 || $b != 0) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 1;
		}
	} elsif ($cmd eq 'xor') {
		$a = pop @{$stack};
		$b = pop @{$stack};
		if (($a != 0) xor ($b != 0)) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 1;
		}

# tlheghjangwI'

	} elsif ($cmd eq 'strmeasure') {
		$str = pop @{$stack};
		push @{$stack}, length($str);

	} elsif ($cmd eq 'strcut') {
		$end = pop @{$stack};
		$begin = pop @{$stack};
		$str = pop @{$stack};
		$end = $end - $begin;	#make the implementation conform
					# to the spec instead of the Perl
					# interpreter
		push @{$stack}, substr ($str, $begin, $end);
	
	} elsif ($cmd eq 'strtie') {
		$s2 = pop @{$stack};
		$s1 = pop @{$stack};
		push @{$stack}, $s1 . $s2;

	} elsif ($cmd eq 'streq?') {
		$s2 = pop @{$stack};
		$s1 = pop @{$stack};
		if ($s1 eq $s2) {
			push @{$stack}, 1;
		} else {
			push @{$stack}, 0;
		}
	} elsif ($cmd eq 'compose') {
		strcompose();

# You can't have a functional language without a conditional clause
#
# (Chris) Don't tempt me!!! :-)
#
# or you'll
# recurse forever and ever AND WE WOULDN'T WANT THAT, NOW, WOULD WE? 
For
# your convenience, var'aq provides two such constructs.

	} elsif ($cmd eq 'ifyes') {
		my $block = pop @{$stack};
		$cval = pop @{$stack};

		if ($cval != 0) {
			execblock($block);
		}

	} elsif ($cmd eq 'ifno') {
		my $block = pop @{$stack};
		$cval = pop @{$stack};

		if ($cval == 0) {
			execblock($block);
		}
	} elsif ($cmd eq 'repeat') {
		$block = pop @{$stack};
		$cval = pop @{$stack};

		while ($cval &gt; 0) {
			execblock($block);
			if ($escv = 1) {
				$cval = 1;
				$escv = 0;
			}
			$cval--;
		}
	} elsif ($cmd eq 'eval') {
		$block = pop @{$stack};
#
# (Jeff) XXX Is the $cval pop (below) supposed to be here? "chov" just 
does
# an execute, so I think this would damage the stack.
#
		$cval = pop @{$stack};

		execblock($block);

# This operator exists for the sole purpose of making it possible to 
string
# a pair of if clauses together. Sharp-eyed code readers will note that
# in this implementation it's simply syntactic sugar for dup/latlh; 
that in
# mind, a more proper implementation might actually typecheck to see if
# that's an actual boolean on the stack.

	} elsif ($cmd eq 'choose') {
		$temp = pop @{$stack};
		push @{$stack}, $temp;
		push @{$stack}, $temp;

# (j proctor) Perl makes escaping easy: if it encounters this in the 
middle of 
# executing a proc, it'll jump immediately to the end of it.  If 
# there's nothing next, well, it's done. 
# (Brian) Note, however, that repeat/vangqa' won't necessarily notice; 
you have
# to give it a nudge.

        } elsif ($cmd eq 'escape') {
                last;
                $escv = 1;
                
# The quote operator (~) will push a bare identifier onto the stack. 
Note that
# it's a special form; it comes *before* its operand. Veddy unusual, 
no?
# This operator is read as lI'moH (make useful) in Klingon.
	
	} elsif ($cmd eq '~') {
		push @{$stack}, $token = token();  # assign to global

# The name instruction takes a proc def and a value off the stack and 
binds
# it to an entry in $proc.

	} elsif ($cmd eq 'name') {
		$proc-&gt;{ pop @{$stack} } = pop @{$stack};

# Set does the same thing for %vars, but the contents get to not be
# write-only.
# (Chris) Mightn't you want to merge these two someday?
# (Brian) Eventually, maybe. Depends on whether I ever figure out how 
to
# separate variable and proc namespaces. At this point, we won't -- it
# isn't really necessary, and the parsing logic does that for us 
anyway.

	} elsif ($cmd eq 'set') {
		$n = pop @{$stack};
		$v = pop @{$stack};
		$vars{$n} = $v;

# At this point, we come down to anything that isn't a keyword.

# First we look for string literals. This makes it possible to do very
# useful things like write "hello, world" programs.  Which you can now 
do.

  	} elsif($cmd =~ /^\"(.*?)\"$/) {
    		push @{$stack}, $1;

# It's not a string, so we assume it's a number. At this point only 
decimal
# notation is supported.

  	} elsif($cmd =~ /^-?\d+.?\d*$/) {
    		push @{$stack}, 0+$cmd;

# Technically, variables and functions aren't in the same namespace, 
but
# since this is how it's parsed, they are, but you don't really want to 
know.
# Just for the sake of argument, let's say they are and do the lookup.

# (Chris) with this, you could just say that variables 'mask' procedure
# definitions.  Again, probably simpler to just merge them into the 
single
# namespace they so obviously share.

	} elsif (exists $vars{$cmd}) {
		push @{$stack}, $vars{$cmd};

# If that doesn't work we look it up in $proc and execute it if it's 
there.
#
# (Jeff) Changed this to call execblock, BUT THIS MAY BE WRONG. Someone
# who knows better than me should have a look at this.
#
  	} elsif(exists $proc-&gt;{$cmd}) {
    		my $block = $proc-&gt;{$cmd};
		execblock($block);

# Otherwise we bitch, whine, and complain to the user.

  	} else {
    		warn "Undefined function '$cmd'";
	}
}

### MAIN ###

print "var'aq Reference Edition -- English v0.5\n";
print "(c)2000 Brian Connors, Chris Pressey, and Mark Shoulson\n\n";
$token = token();
parse();

### END ###

# To those who actually read the code:
#
# Brian sez:
#
# Thanks for taking the time. I have found and continue to find the 
creation
# of this language a major educational experience, and I believe in 
making
# my (or I should say our, since Chris didn't have a problem with this 
either)
# code public record for whatever reason. At this point I'd like to 
thank
# Chris, without whom a lot of this would have been possible but not 
work
# nearly as nicely, and Mark Shoulson from the Klingon Language 
Institute, who
# as I write has only recently come aboard as a linguistic consultant 
to the
# project and will be making the best of his contribution down the road 
a
# ways. The code is free under the Mozilla Public License, yours to do 
with as
# you wish as long as you don't try to tell us that we didn't write it.
#
# Chris sez:
#
# I did an awful lot of random hacking at this and adding comments 
meant
# mainly for Brian, who will likely take them (and possibly) this out
# (feel free, I doubt much of my jabber is actually likely to help some
# interested outside observer understand what's going on in here.)
# Truth be told, I probably broke as much as I fixed; it depends on how
# Brian wants to handle some of the binding issues (at runtime or
# definetime?)
# (Brian) Chris, you're free to jabber as much as you want :-)
</font></pre>


<p>


<table cellspacing=0 cellpadding=0 width="100%">
<tr>
<td colspan=3>
<hr size=1 noshade>
</td>
</tr>
<tr>
<td nowrap valign=top><font face=times size=-1>Click a <img src="http://us.i1.yimg.com/us.yimg.com/i/mesg/online.gif" border=0> to send an instant message to an online friend</td>
<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td align=right nowrap><font face=times size=-1><img src="http://us.i1.yimg.com/us.yimg.com/i/mesg/online.gif" alt="Click to talk" border=0> = Online, <img src="http://us.i1.yimg.com/us.yimg.com/i/mesg/notonline.gif" alt="Offline" border=0> = Offline</font></td>
</tr>
</table>

<table cellpadding=2 cellspacing=0 border=0 width="100%">
<form name=frmShowLtr2 method=post action="/ym/ShowLetter?YY=3721&order=down&sort=date&pos=4">
<input type=hidden name="MsgId" value="8678_3422754_123032_1024_22001_0_0">
<input type=hidden name=box value="Inbox">
<tr bgcolor=#9bbad6>
<td nowrap valign=middle><font face="Arial,Helvetica" size=-1>
<input type=submit name=DEL value="Delete">&nbsp;&nbsp;&nbsp;&nbsp;
<b><a href="/ym/ShowLetter?box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&PREV=1&inc=&num=&Search=&YY=3721&order=down&sort=date&pos=4">Prev</a></b>
|
<b><a href="/ym/ShowLetter?box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&NEXT=1&inc=&num=&Search=&YY=3721&order=down&sort=date&pos=4">Next</a></b>
| <b><a href="/ym/ShowFolder?box=Inbox&YY=3721&order=down&sort=date&pos=4">Inbox</a></b>
</font></td>
<td align=right nowrap><font face="Arial,Helvetica" size=-1>
<select name="destBox" onchange="SynchMoves(2);">
<option value="">- Choose Folder -
<option value="@NEW">[New Folder]
<option value="oracularities">oracularities
</select>
<input type=button value="Move" onclick="MoveTo()">
</font></td>
</tr>
</form>
<form method=post action="/ym/Compose?box=Inbox&Mid=8678_3422754_123032_1024_22001_0_0&inc=&Search=&YY=3721&order=down&sort=date&pos=4">
<tr bgcolor="#ffffff">
<td nowrap valign=middle>
<input type=submit name=REP value="Reply">
<input type=submit name=REPA value="Reply All">
<input type=submit name=FWD value="Forward">
<font face="Arial,Helvetica" size=-2>
<select name="fwopt">
<option value="attach" selected>as attachment
<option value="quoted">inline text
</select>
</font></td>
<td align=right valign=middle nowrap><font face="Arial,Helvetica" size=-1>
<a href="/ym/ShowLetter?box=Inbox&MsgId=8678_3422754_123032_1024_22001_0_0&toc=1&Search=&YY=3721&order=down&sort=date&pos=4"><b>Download</b></a> Attachments
</font></td>
</form>
</tr></table>
<p>

<table cellpadding=0 cellspacing=0 border=0 width="100%"><tr><td bgcolor=#a0b8c8>
<table cellpadding=1 cellspacing=1 border=0 width="100%">
<!-- - btpromo --->
<tr valign=top bgcolor=#ffffff><td align=center>
<a href="http://rd.yahoo.com/footer/trough_promo/?http://im.yahoo.com/" target="_blank">Yahoo! Messenger</a> - Send instant messages to friends!
</td></tr>
<!-- - etpromo --->
<tr valign=top bgcolor=#ffffff><td align=center>
<font face="arial" size=-2>
<A
href="http://rd.yahoo.com/footer/?http://address.yahoo.com/" target=_blank>Address&nbsp;Book</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://alerts.yahoo.com/" target=_blank>Alerts</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://auctions.yahoo.com/" target=_blank>Auctions</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://billpay.yahoo.com/" target=_blank>Bill&nbsp;Pay</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://bookmarks.yahoo.com/" target=_blank>Bookmarks</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://briefcase.yahoo.com/" target=_blank>Briefcase</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://broadcast.yahoo.com/" target=_blank>Broadcast</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://calendar.yahoo.com/" target=_blank>Calendar</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://chat.yahoo.com/" target=_blank>Chat</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://classifieds.yahoo.com/" target=_blank>Classifieds</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://clubs.yahoo.com/" target=_blank>Clubs</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://companion.yahoo.com/" target=_blank>Companion</A> &#183; <A 

href="http://rd.yahoo.com/footer/*http://store.yahoo.com/cgi-bin/clink?ydomains+merchant-ad:commfooter+http://domains.yahoo.com/" target=_blank>Domains</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://experts.yahoo.com/" target=_blank>Experts</A> &#183;<A 

href="http://rd.yahoo.com/footer/?http://games.yahoo.com/" target=_blank>Games</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://greetings.yahoo.com/" target=_blank>Greetings</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://geocities.yahoo.com/" target=_blank>Home&nbsp;Pages</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://invites.yahoo.com/" target=_blank>Invites</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://mail.yahoo.com/" target=_blank>Mail</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://maps.yahoo.com/" target=_blank>Maps</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://members.yahoo.com/" target=_blank>Member&nbsp;Directory</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://messenger.yahoo.com/" target=_blank>Messenger</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://my.yahoo.com/" target=_blank>My&nbsp;Yahoo!</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://news.yahoo.com/" target=_blank>News</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://paydirect.yahoo.com/" target=_blank>PayDirect</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://people.yahoo.com/" target=_blank>People&nbsp;Search</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://personals.yahoo.com/" target=_blank>Personals</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://photos.yahoo.com/" target=_blank>Photos</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://shopping.yahoo.com/" target=_blank>Shopping</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://sports.yahoo.com/" target=_blank>Sports</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://finance.yahoo.com/" target=_blank>Stock&nbsp;Quotes</A> &#183; <A
href="http://rd.yahoo.com/footer/?http://tv.yahoo.com/" target=_blank>TV</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://travel.yahoo.com/" target=_blank>Travel</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://weather.yahoo.com/" target=_blank>Weather</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://www.yahooligans.com/" target=_blank>Yahooligans</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://yp.yahoo.com/" target=_blank>Yellow&nbsp;Pages</A> &#183; <A 

href="http://rd.yahoo.com/footer/?http://docs.yahoo.com/docs/family/more.html" target=_blank>more...</A>
</font>
</td></tr></table>
</td></tr></table><br>
<font size=-1>
<a href="http://privacy.yahoo.com/privacy/us/mail/">Privacy Policy</a>-
<a href="http://docs.yahoo.com/info/terms/">Terms of Service</a>
-
<a href="http://docs.yahoo.com/info/guidelines/mail.html">Guidelines</a>
<BR>
<i>Copyright &copy; 1994-2001
 <a href="http://rd.yahoo.com/mail_us/tos/?http://www.yahoo.com" target="_blank">Yahoo!</a> Inc. All rights reserved.</i>
</font>
</body>
</html>
<!--0.45733-->
<!-- compressed -->
